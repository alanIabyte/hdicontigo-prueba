(this["webpackJsonphdi-contigo"]=this["webpackJsonphdi-contigo"]||[]).push([[17],{1326:function(e,t,n){"use strict";n.r(t);var a,c=n(22),r=n(41),o=n(2),i=n(1),s=n(89);!function(e){e.IDLE="idle",e.RECORDING="recording",e.PAUSED="paused"}(a||(a={}));var u,l,d=function(){var e=Object(i.useRef)([]),t=Object(i.useState)(a.IDLE),n=t[0],c=t[1],r=Object(i.useState)(""),o=r[0],s=r[1],d=Object(i.useState)(""),b=d[0],j=d[1],m=function(){var e=Object(i.useRef)(null),t=Object(i.useState)(0),n=t[0],a=t[1];return{timer:n,handleStartTimer:function(){e.current=setInterval((function(){a((function(e){return e+1}))}),1e3)},handlePauseTimer:function(){clearInterval(e.current)},handleResumeTimer:function(){e.current=setInterval((function(){a((function(e){return e+1}))}),1e3)},handleResetTimer:function(){clearInterval(e.current),a(0)}}}(),O=m.timer,f=m.handleStartTimer,p=m.handlePauseTimer,g=m.handleResumeTimer,h=m.handleResetTimer;return{startRecording:function(){if(n===a.IDLE)try{j(""),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){l=t,(u=new MediaRecorder(t)).start(),u.onstart=function(){f(),c(a.RECORDING)},u.ondataavailable=function(t){e.current.push(t.data)}})).catch((function(e){j(null===e||void 0===e?void 0:e.message)}))}catch(t){j(null===t||void 0===t?void 0:t.message)}},stopRecording:function(){n!==a.IDLE&&(u.stop(),u.onstop=function(){h();var t=new Blob(e.current,{type:"audio/wav;"});e.current=[],s(window.URL.createObjectURL(t)),c(a.IDLE),l.getAudioTracks().forEach((function(e){e.stop()}))})},pauseRecording:function(){n===a.RECORDING&&(u.pause(),u.onpause=function(){p(),c(a.PAUSED)})},resumeRecording:function(){n===a.PAUSED&&(u.resume(),u.onresume=function(){g(),c(a.RECORDING)})},status:n,audioResult:o,errorMessage:b,timer:O}},b=n(183),j=n(56),m=n(9),O=n(6),f=n(48),p=n(45),g=n(91),h=n(87),x=n(78),R=n(52),v=n(454),E=n.p+"static/media/grabacion.ce464db5.svg",I=n.p+"static/media/stop.d7effaae.svg",D=n.p+"static/media/stop-disabled.74892a4d.svg",S=n.p+"static/media/basura-azul.97d50ab5.svg",w=n.p+"static/media/Check.1e7e3cb3.svg",C=(n(531),n(27)),y=n(23),N=n(13),A=n(177),L=n(720),k=n(109),T=n(0),U=function(e){return Object(T.jsx)("div",{className:"semi-circulo-2 color-".concat(e.numero),children:Object(T.jsx)("p",{children:e.numero})})},B=[{id:1,pregunta:"\xbfCu\xe1ndo y a qu\xe9 hora ocurri\xf3?"},{id:2,pregunta:"\xbfEn d\xf3nde ocurri\xf3?"},{id:3,pregunta:"\xbfHab\xeda otros veh\xedculos o terceras personas?"},{id:4,pregunta:"\xbfQui\xe9n fue la \xfaltima persona en conducir el veh\xedculo?"},{id:5,pregunta:"\xbfC\xf3mo ocurri\xf3?"}],G=null;t.default=function(){var e=Object(s.f)(),t=Object(i.useState)(!1),n=Object(o.a)(t,2),u=n[0],l=(n[1],!1),q=Object(s.g)();q&&q.search&&q.search.includes("sinLimites")&&(l=!0);var M=d(),P=M.audioResult,F=M.timer,z=M.startRecording,H=M.stopRecording,J=M.status,Q=M.errorMessage,X=Object(N.b)(),Y=Object(N.c)((function(e){return e})),Z=(Object(L.a)().descargarUrlBlob,Object(i.useState)(!0)),K=Object(o.a)(Z,2),V=K[0],W=K[1],$=Object(i.useState)(!1),_=Object(o.a)($,2),ee=_[0],te=_[1],ne=Object(i.useState)(!1),ae=Object(o.a)(ne,2),ce=ae[0],re=ae[1],oe=Object(i.useState)(!1),ie=Object(o.a)(oe,2),se=ie[0],ue=ie[1],le=Object(i.useState)(""),de=Object(o.a)(le,2),be=de[0],je=de[1],me=Object(i.useState)("00:00:00"),Oe=Object(o.a)(me,2),fe=Oe[0],pe=Oe[1],ge=Object(i.useState)(!1),he=Object(o.a)(ge,2),xe=he[0],Re=he[1],ve=function(){var e=Object(r.a)(Object(c.a)().mark((function e(t){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FileReader).onload=function(e){var t=e.target.result;localStorage.setItem(k.a.descripcionRobo.NOMBREAUDIOLS,t)},n.readAsDataURL(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(r.a)(Object(c.a)().mark((function e(){var t,n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P){e.next=9;break}return e.next=3,fetch(P);case 3:return t=e.sent,e.next=6,t.blob();case 6:n=e.sent,ve(n),W(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){je(P)}),[P]),Object(i.useEffect)((function(){if(J===a.RECORDING)if(l)console.log("No habr\xe1 limitaciones");else{console.log("con limitaciones");G=setTimeout((function(){pe(new Date(1e3*F).toISOString().substr(11,8)),H(),te(!0),clearTimeout(G)}),12e4);setTimeout((function(){ue(!0)}),6e4)}}),[J]),Object(i.useEffect)((function(){var e=localStorage.getItem(k.a.descripcionRobo.NOMBREAUDIOLS);if(e){console.log("entra");var t=function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),c=new Uint8Array(a),r=0;r<t.length;r++)c[r]=t.charCodeAt(r);return new Blob([c],{type:n})}(e),n=URL.createObjectURL(t);console.log(n),je(n),te(!0),W(!1)}else console.log("No hay audio guardado")}),[]),Object(T.jsxs)(m.a,{children:[u?Object(T.jsx)(C.a,{}):null,Object(T.jsx)(y.a,{textoEncabezado:"Eliminar audio",textoCuerpo:"Estas apunto de eliminar el audio que grabaste. \xbfDeseas continuar?",etiquetaBoton:"Eliminar",temaBoton:"rojo",funcionLlamadaBoton:function(){localStorage.removeItem(k.a.descripcionRobo.NOMBREAUDIOLS),te(!1),je(""),re(!1),W(!0),Re(!1)},mostrarModal:xe,manejarCierre:function(){Re(!1)}}),Object(T.jsx)(f.a,{titulo:"Reportar robo total",funcionRegresar:e.goBack}),Object(T.jsxs)(x.h,{style:{paddingTop:"3rem",height:"calc(100vh - 136px)",overflowX:"hidden",overflowY:"auto"},children:[Object(T.jsx)(b.a,{titulo:"Descripci\xf3n del robo",progreso:1}),Object(T.jsx)(p.x,{}),Object(T.jsx)(g.i,{style:{marginTop:"0"},children:"Cu\xe9ntanos qu\xe9 pas\xf3"}),Object(T.jsx)(R.d,{style:{height:"17px"},children:"Graba un audio con lo que ocurri\xf3 apoy\xe1ndote de las siguientes preguntas"}),Object(T.jsx)(v.a,{numeroPreguntas:B.length,children:B.map((function(e,t){return Object(T.jsxs)("div",{style:{display:"flex"},children:[Object(T.jsx)(U,{numero:e.id}),Object(T.jsx)(R.d,{style:{height:"20px",marginLeft:"10px"},children:e.pregunta})]},t)}))}),Object(T.jsx)(p.x,{}),Object(T.jsx)(O.q,{children:"Descripci\xf3n de los hechos"}),Object(T.jsx)(p.w,{}),Object(T.jsxs)("div",{className:"contenedor-flex",style:{flexDirection:"column",alignItems:"center"},children:[!ee&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("img",{src:J===a.RECORDING?se?I:D:E,alt:"",className:"elemento-click",onClick:function(){if(J===a.RECORDING&&se)return te(!0),pe(new Date(1e3*F).toISOString().substr(11,8)),H(),void clearTimeout(G);z(),je(""),ue(!!l)},width:50}),Object(T.jsxs)("p",{children:[new Date(1e3*F).toISOString().substr(11,8)," / 00:0",2,":00"]})]}),Q&&Object(T.jsx)(R.d,{children:Q}),ee&&J!==a.RECORDING&&Object(T.jsxs)("div",{className:"contenedor-flex",style:{alignItems:"center",gap:"10px"},children:[Object(T.jsx)("img",{src:S,onClick:function(){Re(!0)},width:50,className:"elemento-click",alt:"",style:{marginBottom:"15px"}}),Object(T.jsx)("audio",{controls:!0,src:be,style:{marginBottom:"15px"}}),!ce&&Object(T.jsx)("img",{src:w,onClick:Ee,width:50,className:"elemento-click",alt:"",style:{marginBottom:"15px"}})]})]}),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(h.c,{children:Object(T.jsx)(j.a,{tema:"estandar",etiqueta:"Continuar",deshabilitado:V,enClick:function(){var t=A.a.AGREGAR;Y.datosReporteRobo&&(t=A.a.ACTUALIZAR),X({type:t,indice:"datosReporteRobo",indiceExtra:"tiempoGrabacion",valor:fe}),e.push("/robo/info-complementaria")}})}),Object(T.jsx)(j.a,{tema:"simple",etiqueta:"Contacto HDI",enClick:function(){e.push({pathname:"/asistencia-hdi",state:{tipoAtencion:"robo"}})}})]})]})]})}}}]);