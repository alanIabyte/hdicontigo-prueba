(this["webpackJsonphdi-contigo"]=this["webpackJsonphdi-contigo"]||[]).push([[28],{1341:function(e,n,a){"use strict";a.r(n);var i=a(22),t=a(41),r=a(2),o=a(832),l=a(1),d=a(404),c=a(89),m=a(169),u=a(21),s=a(152),k=a(23),b=a(29),v=a(9),p=a(6),f=a(83),g=a(27),N=a(16),j=a(64),y=a(0),O="Resumen y envio",x="Revisa que toda la informaci\xf3n est\xe9 correcta antes de enviar tu reembolso.",h="Documento no agregado.",S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"idPoliza"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"idAsegurado"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"xmlFactura"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folio"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"claimId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"documentacion"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DocumentoReembolso"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"gmm_solicitarReembolso"},arguments:[{kind:"Argument",name:{kind:"Name",value:"idPoliza"},value:{kind:"Variable",name:{kind:"Name",value:"idPoliza"}}},{kind:"Argument",name:{kind:"Name",value:"idAsegurado"},value:{kind:"Variable",name:{kind:"Name",value:"idAsegurado"}}},{kind:"Argument",name:{kind:"Name",value:"xmlFactura"},value:{kind:"Variable",name:{kind:"Name",value:"xmlFactura"}}},{kind:"Argument",name:{kind:"Name",value:"folio"},value:{kind:"Variable",name:{kind:"Name",value:"folio"}}},{kind:"Argument",name:{kind:"Name",value:"claimId"},value:{kind:"Variable",name:{kind:"Name",value:"claimId"}}},{kind:"Argument",name:{kind:"Name",value:"documentacion"},value:{kind:"Variable",name:{kind:"Name",value:"documentacion"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mensaje"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"codigo"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completado"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dato"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folio"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"claimId"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:459,source:{body:"query (\r\n  $idPoliza: String!\r\n  $idAsegurado: Int!\r\n  $xmlFactura: String!\r\n  $folio: String!\r\n  $claimId: String!\r\n  $documentacion: [DocumentoReembolso!]!\r\n) {\r\n  gmm_solicitarReembolso(\r\n    idPoliza: $idPoliza\r\n    idAsegurado: $idAsegurado\r\n    xmlFactura: $xmlFactura\r\n    folio: $folio\r\n    claimId: $claimId \r\n    documentacion: $documentacion\r\n  ) {\r\n    mensaje\r\n    codigo\r\n    completado\r\n    dato {\r\n      folio\r\n      claimId\r\n    }\r\n  }\r\n}\r\n\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"idPoliza"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"idAsegurado"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"xmlFactura"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folio"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"claimId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"documentacion"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DocumentoReembolso"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"gmm_solicitarReembolsoDoc"},arguments:[{kind:"Argument",name:{kind:"Name",value:"idPoliza"},value:{kind:"Variable",name:{kind:"Name",value:"idPoliza"}}},{kind:"Argument",name:{kind:"Name",value:"idAsegurado"},value:{kind:"Variable",name:{kind:"Name",value:"idAsegurado"}}},{kind:"Argument",name:{kind:"Name",value:"xmlFactura"},value:{kind:"Variable",name:{kind:"Name",value:"xmlFactura"}}},{kind:"Argument",name:{kind:"Name",value:"folio"},value:{kind:"Variable",name:{kind:"Name",value:"folio"}}},{kind:"Argument",name:{kind:"Name",value:"claimId"},value:{kind:"Variable",name:{kind:"Name",value:"claimId"}}},{kind:"Argument",name:{kind:"Name",value:"documentacion"},value:{kind:"Variable",name:{kind:"Name",value:"documentacion"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mensaje"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"codigo"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completado"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dato"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folio"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"claimId"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:459,source:{body:"query (\r\n  $idPoliza: String!\r\n  $idAsegurado: Int!\r\n  $xmlFactura: String!\r\n  $folio: Int!\r\n  $claimId: String!\r\n  $documentacion: [DocumentoReembolso!]!\r\n) {\r\n  gmm_solicitarReembolsoDoc(\r\n    idPoliza: $idPoliza\r\n    idAsegurado: $idAsegurado\r\n    xmlFactura: $xmlFactura\r\n    folio: $folio\r\n    claimId: $claimId \r\n    documentacion: $documentacion\r\n  ) {\r\n    mensaje\r\n    codigo\r\n    completado\r\n    dato {\r\n      folio\r\n      claimId\r\n    }\r\n  }\r\n}\r\n\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numeroPoliza"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"beneficiario"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"factura"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"obtener_imagenes_reembolso"},arguments:[{kind:"Argument",name:{kind:"Name",value:"numeroPoliza"},value:{kind:"Variable",name:{kind:"Name",value:"numeroPoliza"}}},{kind:"Argument",name:{kind:"Name",value:"beneficiario"},value:{kind:"Variable",name:{kind:"Name",value:"beneficiario"}}},{kind:"Argument",name:{kind:"Name",value:"factura"},value:{kind:"Variable",name:{kind:"Name",value:"factura"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"codigo"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"completado"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mensaje"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dato"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nombre"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:297,source:{body:"query ($numeroPoliza: String!, $beneficiario: String!, $factura: String!) {\r\n  obtener_imagenes_reembolso(\r\n    numeroPoliza: $numeroPoliza\r\n    beneficiario: $beneficiario\r\n    factura: $factura\r\n  ) {\r\n    codigo\r\n    completado\r\n    mensaje\r\n    dato {\r\n      nombre\r\n      url\r\n    }\r\n  }\r\n}\r\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}},V=u.a.nombreDeCookie,D=function(){var e=Object(c.f)(),n=Object(c.g)(),a=Object(d.a)([V]),u=Object(r.a)(a,1)[0][V];u&&u.Usuario&&u.access_token||e.push("/");var D=u&&u.access_token,F=Object(l.useState)({}),I=Object(r.a)(F,2),z=I[0],$=I[1],P=Object(l.useState)({}),_=Object(r.a)(P,2),R=_[0],q=_[1],w=Object(l.useState)({}),E=Object(r.a)(w,2),L=E[0],B=E[1],C=Object(l.useState)({}),G=Object(r.a)(C,2),M=G[0],Q=G[1],J=Object(l.useState)({}),K=Object(r.a)(J,2),U=K[0],H=K[1],W=Object(l.useState)({}),X=Object(r.a)(W,2),Y=X[0],Z=X[1],ee=Object(l.useState)(""),ne=Object(r.a)(ee,2),ae=ne[0],ie=ne[1],te=Object(l.useState)([]),re=Object(r.a)(te,2),oe=re[0],le=re[1],de=Object(l.useState)(!1),ce=Object(r.a)(de,2),me=ce[0],ue=ce[1],se=Object(l.useState)(!1),ke=Object(r.a)(se,2),be=ke[0],ve=ke[1],pe=Object(l.useState)(!1),fe=Object(r.a)(pe,2),ge=fe[0],Ne=fe[1],je=Object(l.useState)(!1),ye=Object(r.a)(je,2),Oe=ye[0],xe=ye[1],he=Object(o.a)(S),Se=Object(r.a)(he,2),Ae=Se[0],Te=Se[1],Ve=Te.loading,De=Te.error,Fe=Te.data,Ie=Object(o.a)(T,{fetchPolicy:"cache-and-network"}),ze=Object(r.a)(Ie,2),$e=ze[0],Pe=ze[1],_e=Pe.loading,Re=Pe.data,qe=Pe.error,we=Object(o.a)(A,{fetchPolicy:"cache-and-network"}),Ee=Object(r.a)(we,2),Le=Ee[0],Be=Ee[1],Ce=Be.loading,Ge=Be.data,Me=Be.error;Object(l.useEffect)((function(){if(n.state){var a=n.state,i=a.poliza,t=a.documentacion,r=a.numeroPoliza;$(i);var o=t.xmlFactura,l=t.otros;console.log(o,l),q(o),ie(r),le(l),l.forEach((function(e){"BANK"===e.tipoDocumento?Q(e):"MEDICAL"===e.tipoDocumento?H(e):"BILL"===e.tipoDocumento?B(e):Z(e)}))}else e.push("/inicio")}),[]);var Qe=function(e){return e.replaceAll("[","").replaceAll("]","")},Je=function(){var e=Object(t.a)(Object(i.a)().mark((function e(n){var a,t,r,o;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n.base64);case 2:return a=e.sent,e.next=5,a.blob();case 5:if(t=e.sent,r=n.nombre.split(" ").join(""),console.log(Qe(r)),!t){e.next=20;break}return e.next=11,fetch("".concat(s.a.api,"/reembolsos/").concat(ae,"/").concat(z.idAsegurado,"/0/").concat(Qe(r)),{method:"POST",headers:{"Content-Type":"application/octet-stream",authorization:D},body:t}).then((function(e){return e.json()})).then((function(e){return n.base64=e.dato})).catch((function(e){return{error:e}}));case 11:if(null===(o=e.sent)||void 0===o||!o.error){e.next=16;break}console.log("Error"),e.next=18;break;case 16:return console.log(n),e.abrupt("return",o);case 18:return console.log(o),e.abrupt("return",o);case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(t.a)(Object(i.a)().mark((function e(n){var a,t,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=R.nombre.split(" ").join(""),!n){e.next=17;break}return e.next=4,fetch("".concat(s.a.api,"/reembolsos/").concat(ae,"/").concat(z.idAsegurado,"/0/").concat(a),{method:"POST",headers:{"Content-Type":"application/octet-stream",authorization:D},body:n});case 4:return t=e.sent,e.next=7,t.json();case 7:if(r=e.sent,R.base64=r.dato,null===r||void 0===r||!r.error){e.next=13;break}console.log("Error"),e.next=15;break;case 13:return console.log(R),e.abrupt("return",t);case 15:return console.log(t),e.abrupt("return",t);case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Ue=function(e){return e.slice(4,10)},He=function(){e.push("/mis-reembolsos",{numeroPoliza:ae,paginaAnterior:"/resumen-reembolso"})},We=function(){var e=Object(t.a)(Object(i.a)().mark((function e(){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("almost there. Keep pushing"),n=R.base64,console.log(n),ue(!0),e.next=6,Ke(n,R.nombre);case 6:return e.next=8,oe.forEach(function(){var e=Object(t.a)(Object(i.a)().mark((function e(n){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(n);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 8:setTimeout((function(){$e({variables:{numeroPoliza:ae,beneficiario:z.idAsegurado.toString()}})}),1500),setTimeout((function(){Ae({variables:{idPoliza:Ue(ae),idAsegurado:z.idAsegurado.toString(),xmlFactura:R.base64,folio:"",claimId:"",documentacion:[{nombre:"",base64:"",extension:"",tipoDocumento:""}]}})}),3e3);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.useEffect)((function(){if(!_e&&Re&&Re.obtener_imagenes_reembolso.dato){var e=Re.obtener_imagenes_reembolso.dato;e&&e.map((function(e){!function(e){if("xml"===e.nombre.split(".")[1])R.base64=e.url;else for(var n=0;n<oe.length;n++)oe[n].nombre.split(" ").join("")===Qe(e.nombre)&&(oe[n].base64=e.url)}(e)}))}!_e&&qe&&(ue(!1),xe(!0))}),[_e,Re,qe]),Object(l.useEffect)((function(){if(!Ve&&De)return console.log("hay error"),ue(!1),void xe(!0);if(!Ve&&Fe){if(!(Fe.gmm_solicitarReembolso&&Fe.gmm_solicitarReembolso.completado&&Fe.gmm_solicitarReembolso.dato))return xe(!0),void ue(!1);ue(!0);var e=Fe.gmm_solicitarReembolso.dato;Le({variables:{idPoliza:Ue(ae),idAsegurado:z.idAsegurado.toString(),xmlFactura:"",folio:e.folio,claimId:e.claimId,documentacion:oe}})}}),[Ve,Fe,De]),Object(l.useEffect)((function(){!Ce&&Ge&&Ge.gmm_solicitarReembolsoDoc&&(Ge.gmm_solicitarReembolsoDoc.completado&&(ue(!1),xe(!1),ve(!0),Ne(!0)));!Ce&&Me&&(ue(!1),xe(!0))}),[Ce,Ge,Me]),Object(y.jsxs)(v.a,{children:[Object(y.jsx)(f.a,{}),ge&&Object(y.jsx)(k.a,{mostrarModal:ge,colorAlerta:"azul",textoEncabezado:"Solicitud de reembolso enviada correctamente",tipoIcono:"palomita",etiquetaBoton:"Aceptar",temaBoton:"estandar",manejarCierre:function(){return He()},funcionLlamadaBoton:function(){return He()}}),Oe&&Object(y.jsx)(k.a,{mostrarModal:Oe,colorAlerta:"rojo",textoEncabezado:"Oh no! Se produjo un error. Intentalo de nuevo",temaBoton:"estandar",etiquetaBoton:"Aceptar",tipoIcono:"alerta",manejarCierre:function(){return xe(!1)},funcionLlamadaBoton:function(){return xe(!1)}}),Object(y.jsxs)(v.c,{children:[me?Object(y.jsx)(g.a,{}):null,Object(y.jsx)(j.j,{children:O}),Object(y.jsx)(j.h,{children:x}),Object(y.jsxs)(N.i,{style:{display:"flex",width:"100%",flexDirection:"column"},children:[Object(y.jsx)(p.o,{style:{textAlign:"left"},children:"Asegurado"}),Object(y.jsx)(N.m,{children:z.nombre}),Object(y.jsx)(p.o,{style:{textAlign:"left",marginTop:"20px"},children:"N\xfamero de p\xf3liza"}),Object(y.jsx)(N.m,{children:ae}),Object(y.jsx)(p.o,{style:{textAlign:"left",marginTop:"20px"},children:"Facturas"}),Object(y.jsx)(N.m,{children:R.nombre}),Object(y.jsx)(N.m,{children:L.nombre}),Object(y.jsx)(p.o,{style:{textAlign:"left",marginTop:"20px"},children:"Informaci\xf3n bancaria"}),Object(y.jsx)(N.m,{children:0===Object.keys(M).length?h:M.nombre}),Object(y.jsx)(p.o,{style:{textAlign:"left",marginTop:"20px"},children:"Informaci\xf3n medica"}),Object(y.jsx)(N.m,{children:0===Object.keys(U).length?h:U.nombre}),Object(y.jsx)(p.o,{style:{textAlign:"left",marginTop:"20px"},children:"Informaci\xf3n adicional"}),Object(y.jsx)(N.m,{style:{marginBottom:"40px"},children:0===Object.keys(Y).length?h:Y.nombre}),Object(y.jsx)(b.a,{etiqueta:"Enviar solicitud de reembolso",enClick:function(){return We(ae)},deshabilitado:be,tema:"estandar",tipo:"button"})]})]})]},Object(m.a)())};n.default=D}}]);